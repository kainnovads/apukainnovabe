files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/03_fix_dependencies.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      echo "=== Fixing Dependencies ==="
      
      cd /var/app/current
      
      # Clean and reinstall dependencies
      echo "Cleaning node_modules..."
      rm -rf node_modules package-lock.json
      
      echo "Installing dependencies..."
      npm install --production
      
      echo "Building application..."
      npm run build
      
      echo "Installing production dependencies in build..."
      cd build
      npm ci --omit=dev
      
      echo "âœ… Dependencies fixed"
